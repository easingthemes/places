Test 2
<button class="login">login</button>
<script type="module">
  function getAdminUrl({ owner, repo, ref }, api, path = '') {
    return new URL([
      'https://admin.hlx.page/',
      api,
      `/${owner}`,
      `/${repo}`,
      `/${ref}`,
      path,
    ].join(''));
  }

  function getParams() {
    const searchParams = new URLSearchParams(window.location.search);
    const ref = searchParams.get('ref');
    const repo = searchParams.get('repo');
    const owner = searchParams.get('owner');
    return { ref, repo, owner };
  }

  function login() {
    const params = getParams();
    // const host = searchParams.get('host');
    const loginUrl = getAdminUrl(params, 'login');
    let extensionId = 'cookie';
    loginUrl.searchParams.set('extensionId', extensionId);
    const loginWindow = window.open(loginUrl.toString());
  }
  const loginButton = document.querySelector('.login');
  loginButton.addEventListener('click', () => {
    login();
  })
</script>
<script>
  const sk = document.querySelector('helix-sidekick');
  console.log(window.hlx, sk);
  window.addEventListener('loggedin', (s) => {
    console.log('loginggg', s, window.hlx.sidekickConfig, window.hlx);
  });

  window.addEventListener('message', function (e) {
    const data = JSON.parse(e.data);
    // Where does the message come from
    console.log('data', data, window.hlx);
  });
  (async () => {
    const r = await fetch('https://admin.hlx.page/profile');
    const profile = await r.json();
    console.log({ profile });
  })();

</script>
